@* Get the EmployeeData *@

@using Microsoft.EntityFrameworkCore;
@using Employees.Data

@inject IDbContextFactory<EmployeeDataContext> EmployeeDataContextFactory

@page "/"

<PageTitle>Our Employees!</PageTitle>

@if (ShowCreate)
{
    <h3>Add a new employee</h3>
    <div class="row mb-3">

        <label for="firstname" class="col-4 col-form-label">First Name</label>
        <div class="col-8">
            <input id="firstname" name="firstName" type="text" class="form-control" @bind="@NewEmployee.FirstName" />
        </div>
    </div>

    <div class="row mb-3">

        <label for="lastname" class="col-4 col-form-label">Last Name</label>
        <div class="col-8">
            <input id="lastname" name="lastName" type="text" class="form-control" @bind="@NewEmployee.LastName" />
        </div>
    </div>


    <div class="row mb-3">

        <label for="email" class="col-4 col-form-label">Email</label>
        <div class="col-8">
            <input id="email" name="email" type="text" class="form-control" @bind="@NewEmployee.Email" />
        </div>
    </div>


    <div class="row mb-3">

        <label for="department" class="col-4 col-form-label">Department</label>
        <div class="col-8">
            <input id="department" name="department" type="text" class="form-control" @bind="@NewEmployee.Department" />
        </div>
    </div>


    <div class="form-group row mb-3">

        <label for="avatar" class="col-4 col-form-label">Avatar</label>
        <div class="col-8">
            <input id="avatar" name="avatar" type="text" class="form-control" @bind="@NewEmployee.Avatar" />
        </div>
    </div>


    <div class="form-group row mb-3">

        <div class="offset-4 col-8">
            <button name="submit" type="submit" class="btn btn-primary" @onclick="CreateNewEmployee">Submit</button>
        </div>
    </div>
} else
{
    <div class="form-group row mb-3">
        <div class="offset-4 col-8">
            <button name="submit" type="submit" class="btn btn-primary" @onclick="ShowCreateForm">Add a New Employee</button>
        </div>
    </div>

    <p>SHOW THE LIST</p>

  
}


@if (@OurEmployees is not null && @OurEmployees.Count > 0)
{
    <table class="table">
        <thead>
            <tr>
                <th scope="col">ID</th>
                <th scope="col">First Name</th>
                <th scope="col">Last Name</th>
                <th scope="col">Email</th>
                <th scope="col">Department</th>
                <th scope="col">Avatar</th>
                <th scope="col">Edit</th>
                <th scope="col">Delete</th>
            </tr>
        </thead>
        <tbody>
            @foreach(var emp in OurEmployees)
            {
                @if (!@ShowEdit)
                {
                <tr>
                        <th scope="row">@emp.Id</th>
                        <td>@emp.FirstName</td>
                        <td>@emp.LastName</td>
                        <td>@emp.Email</td>
                        <td>@emp.Department</td>
                        <td><img src="@emp.Avatar" width="50" height="50" /></td>
                        <button type="submit" name="submit" class="btn btn-outline-primary m-3" @onclick="() => ShowEditForm(emp)">Edit</button>
                        <button type="submit" name="submit" class="btn btn-outline-danger m-3" @onclick="() => DeleteEmployee(emp)">Delete</button>
                    </tr>
                } else
                {
                    @if (@EmployeeToUpdate is not null && @EmployeeToUpdate.Id == @emp.Id)
                    {
                        <tr>
                            <th scope="row">@emp.Id</th>
                            <td><input id="firstname" name="firstName" type="text" class="form-control" @bind="@EmployeeToUpdate.FirstName" /></td>
                            <td><input id="lastname" name="lastName" type="text" class="form-control" @bind="@EmployeeToUpdate.LastName" /></td>
                            <td><input id="email" name="email" type="text" class="form-control" @bind="@EmployeeToUpdate.Email" /></td>
                            <td><input id="department" name="department" type="text" class="form-control" @bind="@EmployeeToUpdate.Department" /></td>
                            <td><input id="avatar" name="avatar" type="text" class="form-control" @bind="@EmployeeToUpdate.Avatar" /></td>
                            <button type="submit" name="submit" class="btn btn-outline-primary m-3" @onclick="UpdateEmployees">Update Employee</button>

                        </tr>
                    } else
                    {
                        <tr>
                            <th scope="row">@emp.Id</th>
                            <td>@emp.FirstName</td>
                            <td>@emp.LastName</td>
                            <td>@emp.Email</td>
                            <td>@emp.Department</td>
                            <td><img src="@emp.Avatar" width="50" height="50" /></td>
                            <button type="submit" name="submit" class="btn btn-outline-primary m-3" @onclick="() => ShowEditForm(emp)">Edit</button>
                            <button type="submit" name="submit" class="btn btn-outline-danger m-3" @onclick="() => DeleteEmployee(emp)">Delete</button>

                        </tr>
                    }
                }

            }

        </tbody>
    </table>
}
